/*--------------------------------------------------------------*\
  PORTFOLIO

  Anything to do with opening or viewing a project goes here.
\*--------------------------------------------------------------*/var WorkModule={init:function(){this.collapseAllProjects();this.createProjArray();this.showAllProjects();this.workNavigation();this.moveWithScroll();OBC.susyOffCanvasToggle.init($('a[href="#show-info"]'))},collapseAllProjects:function(){$("#work").find(".is-expanded").removeClass("is-expanded").addClass("is-thumb");$("body").removeClass("is-expanded-view").removeClass("is-expanded-view-single").removeClass("is-expanded-view-all")},createProjArray:function(){$("#work").find(".grid-item").each(function(){var e=$(this).attr("id");$.inArray(e,projects)===-1&&projects.push(e)})},showAllProjects:function(){var e=function(){$("#work").find(".is-thumb").toggleClass("is-thumb").toggleClass("is-expanded");$("body").addClass("is-expanded-view").addClass("is-expanded-view-all").removeClass("is-expanded-view-single");var t=$("#work").find(".grid-item").map(function(){var e=$(this),t=e.attr("id");if(!$.trim(e.find(".grid-item__expanded-content").html()).length)return $.ajax({url:"work/"+t+".html",success:function(t){e.find(".grid-item__expanded-content").html(t)}})})};window.location.hash==="#all-projects"&&e();$('a[href="#all-projects"]').on("click",function(){e()});$('a[href="#collapse-projects"]').on("click",function(e){e.preventDefault();WorkModule.collapseAllProjects()});$(document).keydown(function(e){if(e.keyCode===27){e.preventDefault();WorkModule.collapseAllProjects();window.history.pushState({state:2},"work","?page=work");$(this)=!location.hash&&location.href.slice(-1)!="#"}})},moveWithScroll:function(){function e(){$(".grid-item__expanded-content").each(function(){var e=$(this),t=e.find(".grid-item__info"),n=e.find(".close-project"),r=t.height(),i=e.find(".grid-item__images").height(),s=$(window).scrollTop(),o=s+$(window).height(),u=e.offset().top-s,a=e.offset().top+i,f=$(window).scrollTop()-e.offset().top;if(a+r>=o&&u<=s){f=f>i-r?i-r:f;f=f<=0?0:f;t.css("top",f);n.css("top",f);e.parent().find('a[href="#show-info"]').css("top",f>20?f+80:80)}})}$('a[href="#show-info"]').one("click",function(){$(".grid-item__images").on("transitionEnd transitionend webkitTransitionEnd MSTransitionEnd otransitionend",function(t){var n=t.originalEvent.propertyName;n==="width"&&e()})});$(window).scroll(function(){e()})},workNavigation:function(){function t(e,t){var n=e.parent(),r=e.attr("id"),i=projectData[r]!==undefined,s=$.trim(e.find(".grid-item__expanded-content").html()).length;!$("body.show-grid-item__info").length&&!Modernizr.touch&&$(window).width()>=1024&&$("body").addClass("show-grid-item__info");n.find(".is-expanded").removeClass("is-expanded").addClass("is-thumb");console.log(e.attr("id"));e.removeClass("is-thumb").addClass("is-expanded");n.find(".is-thumb").insertAfter(".is-expanded");t!=="load"&&(window.location.hash=r);if(!s&&!i)$.ajax({url:"work/"+r+".html",success:function(t){e.find(".grid-item__expanded-content").html(t)},complete:function(){var e=function(){$("#work").find(".is-expanded").removeClass("is-expanded").addClass("is-thumb");$("body").removeClass("is-expanded-view")};$('a[href="#collapse-projects"]').on("click",function(e){e.preventDefault();WorkModule.collapseAllProjects()})}});else if(i){e.find(".grid-item__expanded-content").html(projectData[r].projectHTML);var o=function(){$("#work").find(".is-expanded").removeClass("is-expanded").addClass("is-thumb");$("body").removeClass("is-expanded-view")};$('a[href="#collapse-projects"]').on("click",function(e){e.preventDefault();WorkModule.collapseAllProjects();window.history.pushState({state:2},"work","?page=work");$(this)=!location.hash&&location.href.slice(-1)!="#"})}}var e=0;if(window.location.hash&&window.location.hash!=="#all-projects"&&Modernizr.history){t($(window.location.hash),"load");e=$.inArray(window.location.hash.replace("#",""),projects);console.log(e);$("body").addClass("is-expanded-view-single").removeClass("is-expanded-view-all")}$(window).on("hashchange",function(){if(window.location.hash!=="#all-projects"){t($(window.location.hash),"load");e=$.inArray(window.location.hash.replace("#",""),projects)}});$(".grid-item").on("click",function(e){e||(e=window.event);var n=$(this),r=$(e.target);if(!n.hasClass("is-expanded")&&!r.is(".close-project")){$("body").addClass("is-expanded-view-single").removeClass("is-expanded-view-all");t(n,"click")}var i=$(".is-expanded").attr("id"),s=$.inArray(i,projects)});var n=$(".is-expanded").attr("id"),e=$.inArray(n,projects);$('.expanded-Proj-Nav[href="#next-proj"]').on("click",function(n){n.preventDefault();var r=e!==projects.length-1?e+1:0,i=projects[r];t($("#"+i),"click");e=e!==projects.length-1?r:0});$('.expanded-Proj-Nav[href="#prev-proj"]').on("click",function(n){n.preventDefault();var r=e!==0?e-1:projects.length-1,i=projects[r];t($("#"+i),"click");e=e!==0?r:projects.length-1});$(document).keydown(function(n){var r=e!==0?e-1:projects.length-1,i=projects[r],s=e!==projects.length-1?e+1:0,o=projects[s];n.stopImmediatePropagation();if($(this).find(".is-expanded-view-single").length&&$(".show-page-work").length){if(n.keyCode==37){t($("#"+i),"keydown");e=e!==0?r:projects.length-1;console.log(e);return!1}if(n.keyCode==39){t($("#"+o),"keydown");e=e!==projects.length-1?s:0;console.log(e);return!1}}})}};