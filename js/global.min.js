/*--------------------------------------------------------------*\
  GLOBAL

  Navigation, lazy-loading work page, basic page setup
\*--------------------------------------------------------------*///global vars
var workPageLoaded=!1,workPageData="",projects=[],projectData={},OBC=function(e,t){"use strict";e.susyOffCanvasToggle={init:function(n){t(n).on("click",function(t){t.preventDefault();e.susyOffCanvasToggle.toggleClasses(this);e.susyOffCanvasToggle.toggleText(n)});return n},toggleClasses:function(e){var n=t("body"),r=t(e).attr("href");r==="#show-info"&&n.toggleClass("show-grid-item__info");if(r==="#aboutme"){var i=t('a[href="'+r+'"]').text()==="close"?"About and Contact":"close";n.toggleClass("show-about").removeClass("show-contact");t('a[href="'+r+'"]').text(i)}r==="#contactme"&&n.toggleClass("show-contact").removeClass("show-about");return n.attr("class")},toggleText:function(e){var n=t(e).filter('[href="#show-info"]'),r=t("body")}};return e}(OBC||{},jQuery),GlobalModule={init:function(){this.preloadWorkPage(0);this.getUrlVars();this.fullHeightPage();this.pageNavigation();OBC.susyOffCanvasToggle.init($(".toggler"))},fullHeightPage:function(){$(".home").css("height",window.innerHeight)},preloadWorkPage:function(e){switch(e){case 0:$.ajax({url:"work.html",async:!0,success:function(e){$(e).find(".grid-item").each(function(){var e=$(this).attr("id");$.inArray(e,projects)===-1&&projects.push(e)})},complete:function(e){workPageLoaded=!0;workPageData=e.responseText;GlobalModule.preloadWorkPage(1);$("#work").html(workPageData).data("pulled","yes");WorkModule.init()}});break;case 1:$.each(projects,function(e,t){$.ajax({url:"work/"+t+".html",success:function(e){projectData[t]={projectHTML:e}}})})}},getUrlVars:function(){var e=[],t,n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++){t=n[r].split("=");e.push(t[0]);e[t[0]]=t[1]}return e},pageChange:function(e){var t=$("#home").height(),n=$("#work").height(),r=$("#about").height();if(window.location.hash){var i=e.split("#");e=i[0];projectID=i[1]}var s=History.getState();console.log(e);console.log("PAGE STATE TITLE = "+s.title);if($("#"+e).hasClass("is-active"))return;console.log("PAGE = "+e+"; DATA PULLED = "+$("#"+e).data("pulled"));if($("#"+e).data("pulled")==="yes"&&e!=="work"||!workPageLoaded)$.ajax({url:e+".html",success:function(t){$("#"+e).html(t).data("pulled","no")},complete:function(){WorkModule.init()}});else if(e==="work"&&workPageLoaded&&$("#work").data("pulled")==="yes"){$("#work").html(workPageData).data("pulled","no");WorkModule.init()}e==="home"&&$('a[href="#home"]').parent("li").hide();$("nav li a[href=#"+e+"]").parent().hide();e==="work"?$('nav li a[href="#home"]').parent().show():e==="home"&&$('nav li a[href="#work"]').parent().show();var o=$("body"),u=o.attr("class").split(/\s+/),a=/^show-page-/,f=parseInt(window.innerWidth*-1+$(".main-nav").width(),10);for(var l=0;l<u.length;l++){var c=u[l];c.match(a)&&o.removeClass(c+" show-about").addClass("show-page-"+e).find("#"+e).addClass("is-active")}$("section").not("#"+e).removeClass("is-active");$('a[href="#aboutme"]').text()==="close"&&$('a[href="#aboutme"]').text("About and Contact");if(e!=="home"){$("body").css("max-height","none");$(".main-nav").css({transform:"translateX("+f+"px)","-ms-transform":"translateX("+f+"px)","-webkit-transform":"translateX("+f+"px)","-o-transform":"translateX("+f+"px)","-moz-transform":"translateX("+f+"px)"});$("#work").css({transform:"translateX(0)","-ms-transform":"translateX(0)","-webkit-transform":"translateX(0)","-o-transform":"translateX(0)","-moz-transform":"translateX(0)"});var h=function(){var e={};return function(t,n,r){r||(r="Wait for window resized");e[r]&&clearTimeout(e[r]);e[r]=setTimeout(t,n)}}(),p="onorientationchange"in window,d=p?"orientationchange":"resize";window.addEventListener(d,function(){$("body").height(window.innerheight)},!1);$(window).resize(function(){h(function(){f=parseInt(window.innerWidth*-1+$(".main-nav").width(),10);$(".show-page-work").find(".main-nav").css({transform:"translateX("+f+"px)","-ms-transform":"translateX("+f+"px)","-webkit-transform":"translateX("+f+"px)","-o-transform":"translateX("+f+"px)","-moz-transform":"translateX("+f+"px)"})},100,"window resized")});$("#work").one("transitionEnd transitionend webkitTransitionEnd MSTransitionEnd otransitionend",function(e){var t=e.originalEvent.propertyName;(t==="transform"||t==="-ms-transform"||t==="-webkit-transform"||t==="-o-transform"||t==="-moz-transform")&&$(".show-page-work").length&&$(this).css({transform:"translateX(0)","-ms-transform":"translateX(0)","-webkit-transform":"translateX(0)","-o-transform":"translateX(0)","-moz-transform":"translateX(0)"})})}if(e!=="work"){$("body").css({"max-height":window.innerHeight});$(".main-nav").css({transform:"translateX(0)","-ms-transform":"translateX(0)","-webkit-transform":"translateX(0)","-o-transform":"translateX(0)","-moz-transform":"translateX(0)"});$("#work").css({transform:"translateX(-100%)","-ms-transform":"translateX(-100%)","-webkit-transform":"translateX(-100%)","-o-transform":"translateX(-100%)","-moz-transform":"translateX(-100%)","-webkit-transition":"all .5s ease-in-out","-moz-transition":"all .5s ease-in-out","-o-transition":"all .5s ease-in-out",transition:"all .5s ease-in-out"})}},pageNavigation:function(){var e=GlobalModule.getUrlVars().page;e===undefined?GlobalModule.pageChange("home"):e!==undefined&&GlobalModule.pageChange(e);$('a[data-nav-type="page"]').on("click",function(e){var t=$(this).attr("href").replace("#","");e.preventDefault();GlobalModule.pageChange(t)});$(document).keydown(function(e){if($(".show-page-work").length&&!$(".is-expanded-view-single").length){if(e.keyCode==37){History.pushState({state:1},"home","?page=home");GlobalModule.pageChange("home");return!1}}else if($(".show-page-home").length&&!$(".is-expanded-view-single").length&&e.keyCode==39){History.pushState({state:2},"work","?page=work");GlobalModule.pageChange("work");return!1}});History.Adapter.bind(window,"statechange",function(){GlobalModule.getUrlVars().page!==undefined?GlobalModule.pageChange(GlobalModule.getUrlVars().page):GlobalModule.pageChange("home")})}};